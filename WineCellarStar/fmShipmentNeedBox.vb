Public Class fmShipmentNeedBox
    Inherits System.Windows.Forms.Form

#Region " Windows Form Designer generated code "

    Public Sub New()
        MyBase.New()

        'This call is required by the Windows Form Designer.
        InitializeComponent()

        'Add any initialization after the InitializeComponent() call

    End Sub

    'Form overrides dispose to clean up the component list.
    Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)
        If disposing Then
            If Not (components Is Nothing) Then
                components.Dispose()
            End If
        End If
        MyBase.Dispose(disposing)
    End Sub

    'Required by the Windows Form Designer
    Private components As System.ComponentModel.IContainer

    'NOTE: The following procedure is required by the Windows Form Designer
    'It can be modified using the Windows Form Designer.  
    'Do not modify it using the code editor.
    Friend WithEvents grBoxes As Infragistics.Win.UltraWinGrid.UltraGrid
    Friend WithEvents UltraButton1 As Infragistics.Win.Misc.UltraButton
    Friend WithEvents UltraButton2 As Infragistics.Win.Misc.UltraButton
    <System.Diagnostics.DebuggerStepThrough()> Private Sub InitializeComponent()
        Dim Appearance1 As Infragistics.Win.Appearance = New Infragistics.Win.Appearance
        Dim UltraGridBand1 As Infragistics.Win.UltraWinGrid.UltraGridBand = New Infragistics.Win.UltraWinGrid.UltraGridBand("Band 0", -1)
        Dim UltraGridColumn1 As Infragistics.Win.UltraWinGrid.UltraGridColumn = New Infragistics.Win.UltraWinGrid.UltraGridColumn("itm_box_serial")
        Dim UltraGridColumn2 As Infragistics.Win.UltraWinGrid.UltraGridColumn = New Infragistics.Win.UltraWinGrid.UltraGridColumn("itm_box_itm_code")
        Dim UltraGridColumn3 As Infragistics.Win.UltraWinGrid.UltraGridColumn = New Infragistics.Win.UltraWinGrid.UltraGridColumn("itm_box_name")
        Dim UltraGridColumn4 As Infragistics.Win.UltraWinGrid.UltraGridColumn = New Infragistics.Win.UltraWinGrid.UltraGridColumn("itm_box_len")
        Dim UltraGridColumn5 As Infragistics.Win.UltraWinGrid.UltraGridColumn = New Infragistics.Win.UltraWinGrid.UltraGridColumn("itm_box_width")
        Dim UltraGridColumn6 As Infragistics.Win.UltraWinGrid.UltraGridColumn = New Infragistics.Win.UltraWinGrid.UltraGridColumn("itm_box_height")
        Dim UltraGridColumn7 As Infragistics.Win.UltraWinGrid.UltraGridColumn = New Infragistics.Win.UltraWinGrid.UltraGridColumn("itm_box_weight")
        Dim UltraGridColumn8 As Infragistics.Win.UltraWinGrid.UltraGridColumn = New Infragistics.Win.UltraWinGrid.UltraGridColumn("itm_box_dept")
        Dim UltraGridColumn9 As Infragistics.Win.UltraWinGrid.UltraGridColumn = New Infragistics.Win.UltraWinGrid.UltraGridColumn("itm_box_who")
        Dim UltraGridColumn10 As Infragistics.Win.UltraWinGrid.UltraGridColumn = New Infragistics.Win.UltraWinGrid.UltraGridColumn("itm_box_when")
        Dim Appearance2 As Infragistics.Win.Appearance = New Infragistics.Win.Appearance
        Dim Appearance3 As Infragistics.Win.Appearance = New Infragistics.Win.Appearance
        Dim Appearance4 As Infragistics.Win.Appearance = New Infragistics.Win.Appearance
        Dim Appearance5 As Infragistics.Win.Appearance = New Infragistics.Win.Appearance
        Dim Appearance6 As Infragistics.Win.Appearance = New Infragistics.Win.Appearance
        Dim Appearance7 As Infragistics.Win.Appearance = New Infragistics.Win.Appearance
        Me.grBoxes = New Infragistics.Win.UltraWinGrid.UltraGrid
        Me.UltraButton1 = New Infragistics.Win.Misc.UltraButton
        Me.UltraButton2 = New Infragistics.Win.Misc.UltraButton
        CType(Me.grBoxes, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.SuspendLayout()
        '
        'grBoxes
        '
        Me.grBoxes.Cursor = System.Windows.Forms.Cursors.Hand
        Me.grBoxes.DataMember = Nothing
        Appearance1.BackColor = System.Drawing.Color.FromArgb(CType(224, Byte), CType(224, Byte), CType(224, Byte))
        Appearance1.BackColor2 = System.Drawing.Color.FromArgb(CType(192, Byte), CType(192, Byte), CType(255, Byte))
        Appearance1.BackGradientStyle = Infragistics.Win.GradientStyle.BackwardDiagonal
        Me.grBoxes.DisplayLayout.Appearance = Appearance1
        Me.grBoxes.DisplayLayout.AutoFitColumns = True
        UltraGridColumn1.Header.VisiblePosition = 0
        UltraGridColumn1.Hidden = True
        UltraGridColumn1.Width = 149
        UltraGridColumn2.Header.VisiblePosition = 1
        UltraGridColumn2.Hidden = True
        UltraGridColumn2.Width = 188
        UltraGridColumn3.CellActivation = Infragistics.Win.UltraWinGrid.Activation.NoEdit
        UltraGridColumn3.Header.Caption = "Box Name"
        UltraGridColumn3.Header.VisiblePosition = 2
        UltraGridColumn3.Width = 223
        UltraGridColumn4.Header.Caption = "Length (inches)"
        UltraGridColumn4.Header.VisiblePosition = 3
        UltraGridColumn4.Width = 173
        UltraGridColumn5.Header.Caption = "Width (inches)"
        UltraGridColumn5.Header.VisiblePosition = 4
        UltraGridColumn5.Width = 181
        UltraGridColumn6.Header.Caption = "Height (inches)"
        UltraGridColumn6.Header.VisiblePosition = 5
        UltraGridColumn6.Width = 175
        UltraGridColumn7.Header.Caption = "Weight (lbs)"
        UltraGridColumn7.Header.VisiblePosition = 6
        UltraGridColumn7.Width = 164
        UltraGridColumn8.Header.Caption = "Department"
        UltraGridColumn8.Header.VisiblePosition = 7
        UltraGridColumn8.Hidden = True
        UltraGridColumn8.Width = 75
        UltraGridColumn9.Header.VisiblePosition = 8
        UltraGridColumn9.Hidden = True
        UltraGridColumn9.Width = 84
        UltraGridColumn10.Header.VisiblePosition = 9
        UltraGridColumn10.Hidden = True
        UltraGridColumn10.Width = 92
        UltraGridBand1.Columns.AddRange(New Object() {UltraGridColumn1, UltraGridColumn2, UltraGridColumn3, UltraGridColumn4, UltraGridColumn5, UltraGridColumn6, UltraGridColumn7, UltraGridColumn8, UltraGridColumn9, UltraGridColumn10})
        Me.grBoxes.DisplayLayout.BandsSerializer.Add(UltraGridBand1)
        Me.grBoxes.DisplayLayout.InterBandSpacing = 10
        Me.grBoxes.DisplayLayout.Override.AllowAddNew = Infragistics.Win.UltraWinGrid.AllowAddNew.TemplateOnBottom
        Me.grBoxes.DisplayLayout.Override.AllowDelete = Infragistics.Win.DefaultableBoolean.True
        Me.grBoxes.DisplayLayout.Override.AllowUpdate = Infragistics.Win.DefaultableBoolean.True
        Me.grBoxes.DisplayLayout.Override.BorderStyleCell = Infragistics.Win.UIElementBorderStyle.None
        Me.grBoxes.DisplayLayout.Override.BorderStyleHeader = Infragistics.Win.UIElementBorderStyle.Solid
        Appearance2.BackColor = System.Drawing.Color.Transparent
        Me.grBoxes.DisplayLayout.Override.CardAreaAppearance = Appearance2
        Appearance3.BackColor = System.Drawing.Color.AliceBlue
        Appearance3.BackColor2 = System.Drawing.Color.LightSteelBlue
        Appearance3.BackGradientAlignment = Infragistics.Win.GradientAlignment.Client
        Appearance3.BackGradientStyle = Infragistics.Win.GradientStyle.BackwardDiagonal
        Me.grBoxes.DisplayLayout.Override.CellAppearance = Appearance3
        Me.grBoxes.DisplayLayout.Override.CellSpacing = 2
        Appearance4.BackColor = System.Drawing.Color.LightSteelBlue
        Appearance4.FontData.Name = "Verdana"
        Appearance4.ForeColor = System.Drawing.Color.Navy
        Appearance4.TextHAlign = Infragistics.Win.HAlign.Left
        Appearance4.ThemedElementAlpha = Infragistics.Win.Alpha.Transparent
        Me.grBoxes.DisplayLayout.Override.HeaderAppearance = Appearance4
        Appearance5.BackColor = System.Drawing.Color.Transparent
        Me.grBoxes.DisplayLayout.Override.RowAppearance = Appearance5
        Appearance6.BackColor = System.Drawing.Color.FromArgb(CType(0, Byte), CType(0, Byte), CType(192, Byte))
        Me.grBoxes.DisplayLayout.Override.RowSelectorAppearance = Appearance6
        Me.grBoxes.DisplayLayout.Override.RowSelectorWidth = 10
        Me.grBoxes.DisplayLayout.Override.RowSpacingAfter = 0
        Me.grBoxes.DisplayLayout.Override.RowSpacingBefore = 0
        Appearance7.BackColor = System.Drawing.Color.Blue
        Appearance7.BackColor2 = System.Drawing.Color.LightSteelBlue
        Appearance7.BackGradientStyle = Infragistics.Win.GradientStyle.VerticalBump
        Me.grBoxes.DisplayLayout.Override.SelectedRowAppearance = Appearance7
        Me.grBoxes.DisplayLayout.RowConnectorStyle = Infragistics.Win.UltraWinGrid.RowConnectorStyle.None
        Me.grBoxes.Font = New System.Drawing.Font("Microsoft Sans Serif", 8.25!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.grBoxes.Location = New System.Drawing.Point(0, 0)
        Me.grBoxes.Name = "grBoxes"
        Me.grBoxes.Size = New System.Drawing.Size(928, 216)
        Me.grBoxes.TabIndex = 16
        '
        'UltraButton1
        '
        Me.UltraButton1.Font = New System.Drawing.Font("Microsoft Sans Serif", 10.0!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.UltraButton1.Location = New System.Drawing.Point(16, 232)
        Me.UltraButton1.Name = "UltraButton1"
        Me.UltraButton1.Size = New System.Drawing.Size(104, 23)
        Me.UltraButton1.TabIndex = 17
        Me.UltraButton1.Text = "Save Boxes"
        '
        'UltraButton2
        '
        Me.UltraButton2.Font = New System.Drawing.Font("Microsoft Sans Serif", 10.0!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.UltraButton2.Location = New System.Drawing.Point(136, 232)
        Me.UltraButton2.Name = "UltraButton2"
        Me.UltraButton2.Size = New System.Drawing.Size(128, 23)
        Me.UltraButton2.TabIndex = 18
        Me.UltraButton2.Text = "Cancel Shipment"
        '
        'fmShipmentNeedBox
        '
        Me.AutoScaleBaseSize = New System.Drawing.Size(5, 13)
        Me.ClientSize = New System.Drawing.Size(922, 270)
        Me.ControlBox = False
        Me.Controls.Add(Me.UltraButton2)
        Me.Controls.Add(Me.UltraButton1)
        Me.Controls.Add(Me.grBoxes)
        Me.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedToolWindow
        Me.MaximizeBox = False
        Me.MinimizeBox = False
        Me.Name = "fmShipmentNeedBox"
        Me.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen
        Me.Text = "Need Box Dimensions"
        CType(Me.grBoxes, System.ComponentModel.ISupportInitialize).EndInit()
        Me.ResumeLayout(False)

    End Sub

#End Region
    Public ItmCode As String
    Public Canceled As Boolean
    Private daBoxes As New SqlClient.SqlDataAdapter
    Public dsBoxes As New DataSet

    Private Sub fmShipmentNeedBox_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Dim dr As DataRow

        LoadGrid(grBoxes, daBoxes, dsBoxes, "select itm_box_serial,itm_box_itm_code,itm_box_len,itm_box_width,itm_box_height,itm_box_weight,itm_box_name,itm_box_dept,itm_box_who,itm_box_when from itm_box where itm_box_itm_code='" + ItmCode + "'", "itm_box")
        dr = dsBoxes.Tables(0).NewRow
        dr("itm_box_name") = ItmCode
        dsBoxes.Tables(0).Rows.Add(dr)
        grBoxes.DataSource = dsBoxes.Tables(0)
        grBoxes.DataBind()

        grBoxes.DisplayLayout.Override.AllowUpdate = Infragistics.Win.DefaultableBoolean.True
        grBoxes.DisplayLayout.Override.AllowDelete = Infragistics.Win.DefaultableBoolean.True
        grBoxes.DisplayLayout.Override.AllowAddNew = Infragistics.Win.UltraWinGrid.AllowAddNew.TemplateOnBottom

    End Sub

    Private Sub UltraButton1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles UltraButton1.Click
        Try
            Dim rw As DataRow

            If dsBoxes.Tables.Count > 0 Then
                For Each rw In dsBoxes.Tables(0).Rows
                    If rw.RowState <> DataRowState.Deleted Then
                        If (rw("itm_box_len") Is DBNull.Value) Or (rw("itm_box_width") Is DBNull.Value) Or (rw("itm_box_height") Is DBNull.Value) Or (rw("itm_box_weight") Is DBNull.Value) Then
                            MsgBox("You must enter box dimensions.", MsgBoxStyle.Critical, "Dimensions?")
                            Exit Sub
                        End If
                        rw("itm_box_itm_code") = ItmCode
                        rw("itm_box_who") = User
                        rw("itm_box_when") = Now
                    End If
                Next
            Else
                MsgBox("You must enter box dimensions.", MsgBoxStyle.Critical, "Dimensions?")
                Exit Sub
            End If
            BindingContext(dsBoxes, "itm_box").EndCurrentEdit()

            daBoxes.Update(dsBoxes, "itm_box")
            Canceled = False
            Me.Hide()
        Catch
            DoError(Err, Me)
        End Try
    End Sub

    Private Sub UltraButton2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles UltraButton2.Click
        Canceled = True
        Me.Hide()
    End Sub

    Private Sub grBoxes_InitializeLayout(ByVal sender As System.Object, ByVal e As Infragistics.Win.UltraWinGrid.InitializeLayoutEventArgs) Handles grBoxes.InitializeLayout

    End Sub

    Private Sub grBoxes_AfterRowInsert(ByVal sender As Object, ByVal e As Infragistics.Win.UltraWinGrid.RowEventArgs) Handles grBoxes.AfterRowInsert
        If nz(e.Row.Cells("itm_box_name").Value) = "" Then
            UpdateNames()
        End If
    End Sub
    Private Sub UpdateNames()
        If grBoxes.Rows.Count = 1 Then
            grBoxes.Rows(0).Cells("itm_box_name").Value = ItmCode
        Else
            Dim rw As Infragistics.Win.UltraWinGrid.UltraGridRow
            Dim cnt As Integer = 1
            For Each rw In grBoxes.Rows
                rw.Cells("itm_box_name").Value = ItmCode + " #" + CStr(cnt)
                cnt += 1
            Next
        End If

    End Sub

    Private Sub grBoxes_AfterRowsDeleted(ByVal sender As Object, ByVal e As System.EventArgs) Handles grBoxes.AfterRowsDeleted
        UpdateNames()
    End Sub
End Class
